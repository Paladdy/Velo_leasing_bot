# ๐ ะะฐัััะพะนะบะฐ ะผัะปััะธัะทััะฝะพััะธ (i18n)

## ะฃััะฐะฝะพะฒะบะฐ

ะะธะฑะปะธะพัะตะบะฐ `aiogram-i18n` ัะถะต ะดะพะฑะฐะฒะปะตะฝะฐ ะฒ `requirements.txt` ะธ ะฝะฐัััะพะตะฝะฐ ะฒ ะฟัะพะตะบัะต.

## ะะพะดะดะตัะถะธะฒะฐะตะผัะต ัะทัะบะธ

- ๐ท๐บ **ะัััะบะธะน** (ru) - ะฟะพ ัะผะพะปัะฐะฝะธั
- ๐น๐ฏ **ะขะฐะดะถะธะบัะบะธะน** (tg)
- ๐บ๐ฟ **ะฃะทะฑะตะบัะบะธะน** (uz)

## ะกัััะบัััะฐ ัะฐะนะปะพะฒ

```
locales/
โโโ ru/
โ   โโโ messages.json    # ะัััะบะธะต ะฟะตัะตะฒะพะดั
โโโ tg/
โ   โโโ messages.json    # ะขะฐะดะถะธะบัะบะธะต ะฟะตัะตะฒะพะดั
โโโ uz/
    โโโ messages.json    # ะฃะทะฑะตะบัะบะธะต ะฟะตัะตะฒะพะดั
```

## ะะธะณัะฐัะธั ะฑะฐะทั ะดะฐะฝะฝัั

ะะตัะตะด ะฟะตัะฒัะผ ะทะฐะฟััะบะพะผ ะฒัะฟะพะปะฝะธัะต SQL ะผะธะณัะฐัะธั ะดะปั ะดะพะฑะฐะฒะปะตะฝะธั ะฟะพะปั `language` ะฒ ัะฐะฑะปะธัั `users`:

```bash
# ะงะตัะตะท psql
psql -U your_user -d your_database -f init.sql/add_language_field.sql

# ะะปะธ ัะตัะตะท docker
docker exec -i your_postgres_container psql -U your_user -d your_database < init.sql/add_language_field.sql
```

ะะปััะตัะฝะฐัะธะฒะฝะพ, ะผะพะถะฝะพ ะทะฐะฟัััะธัั Python ัะบัะธะฟั (ะตัะปะธ ะฝะฐัััะพะตะฝะพ ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต):

```bash
python scripts/add_language_field.py
```

## ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั

### 1. ะัะธ ัะตะณะธัััะฐัะธะธ

ะะพะฒัะผ ะฟะพะปัะทะพะฒะฐัะตะปัะผ ะฟัะตะดะปะฐะณะฐะตััั ะฒัะฑัะฐัั ัะทัะบ ะฟะตัะตะด ะฝะฐัะฐะปะพะผ ัะตะณะธัััะฐัะธะธ:
- ะัะพะฑัะฐะถะฐะตััั ะผะตะฝั ั ััะตะผั ัะทัะบะฐะผะธ
- ะัะฑัะฐะฝะฝัะน ัะทัะบ ัะพััะฐะฝัะตััั ะฒ ะฑะฐะทั ะดะฐะฝะฝัั
- ะัะต ะฟะพัะปะตะดัััะธะต ัะพะพะฑัะตะฝะธั ะพัะพะฑัะฐะถะฐัััั ะฝะฐ ะฒัะฑัะฐะฝะฝะพะผ ัะทัะบะต

### 2. ะะทะผะตะฝะตะฝะธะต ัะทัะบะฐ

ะกััะตััะฒัััะธะต ะฟะพะปัะทะพะฒะฐัะตะปะธ ะผะพะณัั ะธะทะผะตะฝะธัั ัะทัะบ ัะตัะตะท ะฟัะพัะธะปั:
1. ะะตัะตะนัะธ ะฒ "๐ค ะัะพัะธะปั"
2. ะะฐะถะฐัั "๐ ะะทะผะตะฝะธัั ัะทัะบ"
3. ะัะฑัะฐัั ะฝะพะฒัะน ัะทัะบ

### 3. ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฟัะตะดะตะปะตะฝะธะต ัะทัะบะฐ

ะัะธ ะบะฐะถะดะพะผ ะทะฐะฟัะพัะต ัะธััะตะผะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ:
1. ะะพะปััะฐะตั Telegram ID ะฟะพะปัะทะพะฒะฐัะตะปั
2. ะะฐะณััะถะฐะตั ะตะณะพ ัะทัะบ ะธะท ะฑะฐะทั ะดะฐะฝะฝัั
3. ะัะธะผะตะฝัะตั ัะพะพัะฒะตัััะฒัััะธะต ะฟะตัะตะฒะพะดั

## ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒัั ะฟะตัะตะฒะพะดะพะฒ

### ะกัััะบัััะฐ JSON ัะฐะนะปะฐ

```json
{
  "language": {
    "name": "ะัััะบะธะน ๐ท๐บ",
    "code": "ru"
  },
  
  "common": {
    "back": "โ๏ธ ะะฐะทะฐะด",
    "cancel": "โ ะัะผะตะฝะฐ"
  },
  
  "start": {
    "welcome_back": "๐ ะะพะฑัะพ ะฟะพะถะฐะปะพะฒะฐัั ะพะฑัะฐัะฝะพ, {name}!"
  }
}
```

### ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒะพะณะพ ะฟะตัะตะฒะพะดะฐ

1. ะัะบัะพะนัะต ัะพะพัะฒะตัััะฒัััะธะน `messages.json`
2. ะะพะฑะฐะฒััะต ะฝะพะฒัะน ะบะปัั ะฒ ะฝัะถะฝัั ัะตะบัะธั
3. ะกะพััะฐะฝะธัะต ัะฐะนะป
4. ะะตัะตะทะฐะฟัััะธัะต ะฑะพัะฐ

### ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ะบะพะดะต

#### ะะฐัะธะฐะฝั 1: ะััะผะพะน ะดะพัััะฟ ะบ ะฟะตัะตะฒะพะดะฐะผ (ัะตะบััะธะน ะฟะพะดัะพะด)

```python
# ะะพะปััะฐะตะผ ัะทัะบ ะฟะพะปัะทะพะฒะฐัะตะปั ะธะท ะะ
user_language = user.language  # "ru", "tg" ะธะปะธ "uz"

# ะกะพะทะดะฐะตะผ ัะปะพะฒะฐัั ั ะฟะตัะตะฒะพะดะฐะผะธ
messages = {
    "ru": "ะะพะฑัะพ ะฟะพะถะฐะปะพะฒะฐัั!",
    "tg": "ะฅัั ะพะผะฐะดะตะด!",
    "uz": "Xush kelibsiz!"
}

# ะัะฟัะฐะฒะปัะตะผ ัะพะพะฑัะตะฝะธะต ะฝะฐ ะฝัะถะฝะพะผ ัะทัะบะต
await message.answer(messages.get(user_language, messages["ru"]))
```

#### ะะฐัะธะฐะฝั 2: ะงะตัะตะท aiogram-i18n (ะดะปั ะฑัะดััะตะณะพ ัะฐััะธัะตะฝะธั)

```python
from aiogram_i18n import I18nContext

async def some_handler(message: Message, i18n: I18nContext):
    # ะะฒัะพะผะฐัะธัะตัะบะธ ะธัะฟะพะปัะทัะตั ัะทัะบ ะฟะพะปัะทะพะฒะฐัะตะปั
    await message.answer(i18n.get("start-welcome_back", name=user.full_name))
```

## ะขะตะบััะธะน ััะฐััั

โ **ะะตะฐะปะธะทะพะฒะฐะฝะพ:**
- ะะพะฑะฐะฒะปะตะฝะธะต ะฟะพะปั `language` ะฒ ะผะพะดะตะปั User
- ะกะพะทะดะฐะฝะธะต JSON ัะฐะนะปะพะฒ ั ะฟะตัะตะฒะพะดะฐะผะธ ะดะปั 3 ัะทัะบะพะฒ
- ะัะฑะพั ัะทัะบะฐ ะฟัะธ ัะตะณะธัััะฐัะธะธ
- ะะทะผะตะฝะตะฝะธะต ัะทัะบะฐ ัะตัะตะท ะฟัะพัะธะปั
- Middleware ะดะปั ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ะพะฟัะตะดะตะปะตะฝะธั ัะทัะบะฐ
- ะัะพะฑัะฐะถะตะฝะธะต ัะตะบััะตะณะพ ัะทัะบะฐ ะฒ ะฟัะพัะธะปะต

๐ **ะกะปะตะดัััะธะต ัะฐะณะธ:**
1. ะะฐะฟัััะธัั ะผะธะณัะฐัะธั ะะ ะดะปั ะดะพะฑะฐะฒะปะตะฝะธั ะฟะพะปั `language`
2. ะัะพัะตััะธัะพะฒะฐัั ัะตะณะธัััะฐัะธั ั ะฒัะฑะพัะพะผ ัะทัะบะฐ
3. ะะพััะตะฟะตะฝะฝะพ ะฟะตัะตะฒะพะดะธัั ะฒัะต ัะพะพะฑัะตะฝะธั ะฝะฐ ะธัะฟะพะปัะทะพะฒะฐะฝะธะต JSON ัะฐะนะปะพะฒ
4. ะะตัะตะฒะตััะธ ัััะตััะฒัััะธะต ัะพะพะฑัะตะฝะธั ะฝะฐ ัะฐะดะถะธะบัะบะธะน ะธ ัะทะฑะตะบัะบะธะน

## ะะพะปะตะทะฝัะต ััะฝะบัะธะธ

### `change_user_language(telegram_id, new_language)`

ะะทะผะตะฝัะตั ัะทัะบ ะฟะพะปัะทะพะฒะฐัะตะปั ะฒ ะฑะฐะทะต ะดะฐะฝะฝัั.

```python
from bot.utils.i18n import change_user_language

success = await change_user_language(telegram_id=123456789, new_language="tg")
```

### `get_language_name(language_code)`

ะะพะทะฒัะฐัะฐะตั ะฝะฐะทะฒะฐะฝะธะต ัะทัะบะฐ ั ัะปะฐะณะพะผ.

```python
from bot.utils.i18n import get_language_name

name = get_language_name("ru")  # "ะัััะบะธะน ๐ท๐บ"
```

## ะะตะบะพะผะตะฝะดะฐัะธะธ

1. **ะะดะธะฝะพะพะฑัะฐะทะธะต**: ะัะฟะพะปัะทัะนัะต ะพะดะธะฝะฐะบะพะฒัะต ะบะปััะธ ะฒะพ ะฒัะตั ัะทัะบะพะฒัั ัะฐะนะปะฐั
2. **ะะฐัะฐะผะตััั**: ะัะฟะพะปัะทัะนัะต `{parameter}` ะดะปั ะดะธะฝะฐะผะธัะตัะบะธั ะทะฝะฐัะตะฝะธะน
3. **ะขะตััะธัะพะฒะฐะฝะธะต**: ะัะพะฒะตััะนัะต ะฟะตัะตะฒะพะดั ะฝะฐ ะฒัะตั ัะทัะบะฐั
4. **ะะตะทะตัะฒะฝัะน ัะทัะบ**: ะัะตะณะดะฐ ัะบะฐะทัะฒะฐะนัะต ััััะบะธะน ะบะฐะบ fallback

## ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะัะธะผะตั 1: ะัะธะฒะตัััะฒะธะต ั ะธะผะตะฝะตะผ

```python
messages = {
    "ru": f"ะัะธะฒะตั, {user.full_name}!",
    "tg": f"ะกะฐะปะพะผ, {user.full_name}!",
    "uz": f"Salom, {user.full_name}!"
}
await message.answer(messages.get(user.language, messages["ru"]))
```

### ะัะธะผะตั 2: ะกัะฐััั ะดะพะบัะผะตะฝัะพะฒ

```python
status_messages = {
    "ru": "โณ ะะฐัะธ ะดะพะบัะผะตะฝัั ะฝะฐ ะฟัะพะฒะตัะบะต",
    "tg": "โณ าฒัาทาทะฐัาณะพะธ ััะผะพ ะดะฐั ัะฐะฝาทะธั",
    "uz": "โณ Hujjatlaringiz tekshiruvda"
}
text = status_messages.get(user.language, status_messages["ru"])
```

## ะะพะดะดะตัะถะบะฐ

ะัะธ ะฒะพะทะฝะธะบะฝะพะฒะตะฝะธะธ ะฟัะพะฑะปะตะผ:
1. ะัะพะฒะตัััะต ะฝะฐะปะธัะธะต ะฟะพะปั `language` ะฒ ัะฐะฑะปะธัะต `users`
2. ะฃะฑะตะดะธัะตัั, ััะพ JSON ัะฐะนะปั ะฒะฐะปะธะดะฝั
3. ะัะพะฒะตัััะต ะปะพะณะธ ะฑะพัะฐ ะฝะฐ ะฝะฐะปะธัะธะต ะพัะธะฑะพะบ i18n
4. ะฃะฑะตะดะธัะตัั, ััะพ middleware ะฝะฐัััะพะตะฝ ะบะพััะตะบัะฝะพ ะฒ `main.py`

